\قسمت{میان‌افزارها}

یکی از نیازمندی‌های عملی کردن دنیای مرتبط، تعامل‌پذیری میان اشیا گوناگون است یا به عبارت دیگر گونه‌های مختلف اشیا بتوانند با یکدیگر صحبت کنند.
البته این کار بسیار سخت به نظر می‌رسد چرا که این اشیا از سخت‌ها افزارهای گوناگون استفاده می‌کنند.
راه‌کارهای میان‌افزارها می‌توانند یک نقش اساسی در ارتباط میان بازار توزیع شده و صنعت اینترنت اشیا ایفا کنند.
مشخصا میان‌افزارها می‌توانند به دستگاه‌های مرتبط کمک کنند تا با وجود استفاده از ``زبان'' خودشان باز هم بتوانند با یکدیگر ارتباط برقرار کرده و یکدیگر را ``درک'' کنند.
با وجود اینکه رسیدن به یک استاندارد کلی برای اینترنت اشیا، یک کار چالشی به نظر می‌رسد اما برای برنامه‌نویسان مستقل و سازمان‌ها یک راه‌کار میان‌افزاری خوش‌تعریف
که بتواند سیگنال‌های سخت‌افزاری سطح پایین را درک کرده و آن‌ها را به منابع قابل دسترس در وب تبدیل کند،
بسیار کمک کننده خواهد
\مرجع{Yun2019}.

میان‌افزارها با انتزاعی ساختن پیچیدگی‌های سیستم یا سخت‌افزار، اجازه می‌دهند برنامه‌نویسان همه تلاش خود را روی کاری که می‌بایست صورت بپذیرد، تمرکز کنند
\مرجع{Razzaque2016}.

پژوهش‌های مختلفی بر عملیاتی کردن میان‌افزارها در محیط‌های هوشمند برای کاربردهای گوناگون کار کرده‌اند.
بخش عمده‌ای از این تلاش‌ها در حوزه مشخص کردن و شفاف‌سازی نیازمندی‌های یک میان‌افزار اینترنت اشیا شامل
تبدیل پروتکل‌های شبکه، مدیریت شبکه و دستگاه‌ها، جستجوی منابع، رابط برنامه‌های کاربردی مبتنی بر \متن‌لاتین{ReST}، معنا، امنیت، پشتبانی از پردازش مِه و ابر است
\مرجع{Yun2019}.

بیشتر تحقیقات و مرورهایی که در این حوزه صورت پذیرفته است، میان افزار اینترنت اشیا، که گاها از آن به عنوان پلتفرم اینترنت اشیا نیز یاد می‌شود، را جزئی حیاتی در
توسعه حوزه اینترنت اشیا می‌نامند. نیازمندی‌های میان‌افزار اینترنت اشیا را می‌توان در دو گروه کارکردی و غیرکارکردی تقسیم‌بندی نمود که در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا}
آمده است
\مرجع{Yun2019}.

\شروع{لوح}
\شرح{نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا}
\برچسب{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا}

\تنظیم‌ازوسط
\شروع{جدول}{cc}

\خط‌بالا

نیازمندی‌های کارکردی &
نیازمندی‌های غیرکارکردی \\

\خط‌میان

اکتشاف منابع &
مقیاس‌پذیری \\

مدیریت منابع &
همزمان بودن \\

مدیریت داده‌ها &
دسترس‌پذیری \\

مدیریت رویدادها &
امنیت \\

مدیریت کدها &
حریم‌خصوصی \\

&
سادگی در توسعه، نگهداری و استفاده \\

&
تعامل‌پذیری \\

&
تعامل خود به خود \\

&
تعدد \\

&
انعطاف‌پذیری و تطبیق‌پذیری \\

\خط‌پایین

\پایان{جدول}

\پایان{لوح}

منظور از ``تعدد'' در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا} انتخاب منبع بر اساس شرایط آن منبع است، مثلا
انتخاب بهترین یا آماده‌ترین دستگاه اینترنت اشیا بین همه دستگاه‌هایی که یک سرویس یکسان ارائه می‌کنند.
منظور از ``تعامل خود به خود'' در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا}
تعامل با دستگاه‌های تازه ثبت شده با شناسه مناسب مانند شناسه یکتا شی جهانی (اختصارا \متن‌لاتین{OID}) است.
منظور از ``مدیریت کد'' در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا}
مدیریت قابلیت‌های دستگاه‌ها‌است.
\مرجع{Yun2019}.

صدها موسسه استانداردسازی بر روی توسعه استانداردهای اینترنت اشیا در جهت جلوگیری از قطعه قطعه شدن افق اینترنت اشیا کار می‌کنند.
در این میان، \متن‌لاتین{oneM2M} هدف توسعه یک استاندارد تکنیکال، با در نظر گرفتن یک لایه سرویس افقی مشترک میان کاربردهای مختلف اینترنت اشیا برای
یک سرویس با قابلیت اجرای جهانی و مستقل از لایه دسترسی، را کلید زده است.
استاندارد \متن‌لاتین{oneM2M} بر روی تعامل‌پذیری در لایه سرویس به جای پشته پروتکلی شبکه و لایه‌های اینترنت مانند \متن‌لاتین{IEEE 802.15.4} و شبکه‌های بی‌سیم برد بالا، تمرکز کرده است.
بنابراین استاندارد \متن‌لاتین{oneM2M} سرویس‌های کارکردی مشترک برای سیستم‌های اینترنت اشیا شامل ثبت دستگاه‌ها و اکتشاف، مدیریت و مخزن داده‌ها، اشتراک و اعلان‌ها، معانی، امنیت و \نقاط‌خ
تعریف کرده است که بیشتر نیازمندی‌های ارائه شده در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا} را پوشش می‌دهد.
مختصرا رویه‌ای که برای ارائه استاندارد \متن‌لاتین{oneM2M} طی شده است شامل جمع‌آوری کارکردها از حوزه‌های تجاری مختف و بعد از آن
فرمول‌بندی نیازمندی‌ها برای لایه سرویس مشترک \متن‌لاتین{oneM2M} و بعد از آن طراحی معماری سیستم است
\مرجع{Yun2019} \مرجع{Kim2016}.

تعامل‌پذیری در اینترنت اشیا به واسطه استفاده از یک زبان یکسان (مانند یک استاندارد جهانی مشابه \متن‌لاتین{oneM2M})
یا تبدیل و ترجمه پروتکل‌ها و پیام‌های دو سیستم مختلف برای یکدیگر بدست می‌آید که نقش کلیدی میان‌افزار اینترنت اشیا است.
با این وجود یک ویژگی مهم دیگر میان‌افزار اینترنت اشیا، مشخصا برای دستگاه‌ها (مانند سیستم‌های نهفته)، فراهم آوردن یک لایه انتزاعی که لایه‌ی رابط‌های سخت‌افزاری پیچیده زیرین را پنهان می‌کند
و به جای آن رابط‌های برنامه‌نویسی کاربردی را ارائه می‌دهد که برنامه‌های اینترنت اشیا می‌توانند به منابعشان در پلتفرم اینترنت اشیا دسترسی پیدا کنند
\مرجع{Yun2019}.
بر پایه معماری \متن‌لاتین{oneM2M} پژوهش‌های \مرجع{Yun2019} و \مرجع{Kim2016} نرم‌افزار تطبیق شی یا اختصارا \متن‌لاتین{TAS} را برای دسترسی استاندارد در مقایس جهانی به اشیا شبکه‌های حسگر بی‌سیم
را معرفی کرده‌اند.

وظیفه اصلی نرم‌افزار تطبیق شی، انطباق داده یعنی تبدیل کردن داده‌های جمع‌آوری شده از یک شی به یک فرمت استاندارد برای پردازش بیشتر و به صورت مشابه
ترجمه یک پیام دستوری به دستور مشابه‌اش برای شی است.
از سوی دیگر \متن‌لاتین{TAS} می‌تواند قابلیت ارتباط میان دو سیستم که یکی از \متن‌لاتین{oneM2M} پشتیبانی می‌کند و
دیگری پشتیبانی نمی‌کند را فراهم آورد
\مرجع{Kim2016}.

\شروع{شکل}
\تنظیم‌ازوسط
\درج‌تصویر[width=\textwidth]{./img/onem2m-reference-architecture.png}
\شرح{معماری مرجع \متن‌لاتین{oneM2M} \مرجع{Yun2019}}
\برچسب{شکل: معماری مرجع oneM2M}
\پایان{شکل}

استاندارد \متن‌لاتین{oneM2M} از معماری مبتنی بر منابع یا اختصارا \متن‌لاتین{ROA} پشتیبانی می‌کند و یک مدل لایه‌ای مشابه با شکل \رجوع{شکل: معماری مرجع oneM2M} را برگزیده است.
محیط‌های معماری شکل \رجوع{شکل: معماری مرجع oneM2M} به دو حوزه تقسیم شده‌اند. حوزه زیرساخت که گرههای زیرساخت یا اختصارا \متن‌لاتین{IN}ها در آن قرار گرفته‌اند.
دامنه عملیاتی که در آن گرههای میانی یا اختصارا \متن‌لاتین{MN}ها، گرههای سرویس اپلیکیشن یا اختصارا \متن‌لاتین{ASN}ها و گرههای انحصاری اپلیکیشن یا اختصارا \متن‌لاتین{ADN}ها
در آن قرار گرفته‌اند.
گرههای \متن‌لاتین{IN}، \متن‌لاتین{MN} و \متن‌لاتین{ASN} می‌بایست شامل موجودیت‌های سرویس مشترک یا اختصارا \متن‌لاتین{CSE}ها باشند که سرویس‌های کارکردی مشترک
(مانند نیازمندی‌های کارکردی شرح داده شده در جدول \رجوع{جدول: نیازمندی‌های کارکردی و غیرکارکردی میان‌افزار اینترنت اشیا})
را برای سایر \متن‌لاتین{CSE}ها یا موجودیت‌های اپلیکیشن (اختصارا \متن‌لاتین{AE}ها)
فراهم می‌آورند.
\متن‌لاتین{AE}ها منطق سرویس اپلیکیشن مانند حسگر و یا عملگر را فراهم می‌آورند.
سرویس‌های شبکه‌ای به واسطه موجودیت‌های سرویس شبکه یا اختصارا \متن‌لاتین{NSE}ها که در لایه‌ی پایین، با نام لایه سرویس شبکه، قرار گرفته‌اند، فراهم می‌شوند
\مرجع{Yun2019}.

اگر بخواهیم دقیق‌تر صحبت کنیم، معماری \متن‌لاتین{oneM2M} با هدف برقراری ارتباط میان اشیا و اپلیکیش‌ها به واسطه سرور اینترنت اشیا تمرکز می‌کند و هم اپلیکیشن و هم
اشیا را در حوزه عملیاتی قرار می‌دهد. به طور مثال در پژوهش \مرجع{Yun2019} سناریوهای حسگر و عملگر در این معماری پیشنهاد شده‌اند که در شکل‌های
\رجوع{شکل:سناریو پیشنهادی با استفاده از معماری استاندارد oneM2M برای کارکردهای عملگری} و \رجوع{شکل:سناریو پیشنهادی با استفاده از معماری استاندارد oneM2M برای کارکردهای حسگری}
آورده شده‌اند. در این سناریو یک شی و یک دستگاه تلفن همراه قرار گرفته‌اند. شی در نقش حسگر اطلاعات را برای سرور اینترنت اشیا ارسال کرده و اپلیکیشن تلفن همراه می‌تواند
با استفاده از رویه اشتراک و اطلاع یا تقاضا و پاسخ اطلاعات را دریافت کند. شی در نقش عملگر وضعیت خود را به سرور اینترنت اشیا ارسال کرده و برای دریافت دستورات مشترک
می‌شود.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./img/onem2m-standard-based-actuation.png}
\شرح{سناریو پیشنهادی پژوهش \مرجع{Yun2019} با استفاده از معماری استاندارد \متن‌لاتین{oneM2M} برای کارکردهای عملگری}
\برچسب{شکل:سناریو پیشنهادی با استفاده از معماری استاندارد oneM2M برای کارکردهای عملگری}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./img/onem2m-standard-based-sensing.png}
\شرح{سناریو پیشنهادی پژوهش \مرجع{Yun2019} با استفاده از معماری استاندارد \متن‌لاتین{oneM2M} برای کارکردهای حسگری}
\برچسب{شکل:سناریو پیشنهادی با استفاده از معماری استاندارد oneM2M برای کارکردهای حسگری}
\پایان{شکل}

همانطور که پیشتر بیان شد، معماری \متن‌لاتین{oneM2M} از مدل \متن‌لاتین{ROA} یا معماری مبتنی بر منابع استفاده می‌کند.
بنابراین سرویس و داده‌ای که سیستم \متن‌لاتین{oneM2M} پشتیبانی می‌کند به عنوان مدل اطلاعاتی منابع مدیریت و منتشر می‌کند.
با مفهوم \متن‌لاتین{ROA}، منابع در \متن‌لاتین{ROA} می‌توانند به صورت یکتا به واسطه شناسه منبع یکتا یا مختصرا \متن‌لاتین{URI}
آدرس‌دهی شوند و تعامل با منابع به واسطه چهار عمل پایه‌ای \متن‌لاتین{CRUD} شامل ساخت، دریافت، به روزرسانی و پاک کردن پشتیبانی می‌شود.
در نهایت بر پایه عملیات‌های \متن‌لاتین{CRUD} و \متن‌لاتین{URI}، \متن‌لاتین{API}ها ساختار ساده‌ای مشابه با \متن‌لاتین{API}های وب خواهند داشت
\مرجع{Kim2016}.

پژوهش \مرجع{Kim2016} برای شناسایی اشیا در معماری \متن‌لاتین{oneM2M} استفاده از \متن‌لاتین{OID} را پیشنهاد می‌دهد.
یک \متن‌لاتین{OID} از مجموعه‌ای از گره‌ها تشکیل شده است که به صورت سلسله مراتبی هر گره از گره بالایی تخصیص پیدا می‌کنند.
این گره‌ها با نقطه از یکدیگر جدا شده‌اند. شِما پیشنهادی در پژوهش \مرجع{Kim2016} با یک ریشه یکتا که به وسیله‌ی یک اداره استاندارسازی منتشر،
می‌شود، آغاز می‌شود. در ادامه شناسه‌ی سازنده، شماره‌ی مدل و سریال دستگاه قرار می‌گیرند.

\زیرقسمت{نیازمندی‌ها}

به صورت کلی، یک میان‌افزار پیچدگی‌های سیستم یا سخت‌افزار را انتزاعی کرده و اجازه می‌دهد
توسعه‌دهندگان برنامه‌های کاربردی همه تلاش خود را روی کاری که باید انجام شود، متمرکز کنند بدون
اینکه دغدغه‌هایی در سطح سیستم یا سخت‌افزار داشته باشند.
در اینترنت اشیا، تنوع زیادی در تکنولوژی‌های ارتباطی مورد استفاده و تکنولوژی‌های سطح سیستم وجود دارد که
میان‌افزار می‌بایست از هر دو دیدگاه تا حد لازم پشتیبانی کند.
نیازمندی‌های میان‌افزار برای پشتیبانی از اینترنت اشیا را می‌توان به دو دسته نیازمندی‌های کارکردی و غیرکارکردی تقسیم کرد.
نیازمندی‌های کارکردی شامل سرویس‌ها و کارکردها می‌شوند و نیازمندی‌های غیرکارکردی شامل پشتیبانی از کیفیت سرویس
و مشکلات کارایی می‌شوند.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./img/iot-arch-ref.drawio.png}
\پایان{شکل}

\زیرزیرقسمت{مدیریت ارتباط}

اشیا می‌توانند از پروتکل‌های ارتباطی مختلفی پشتیبانی کنند اما پلتفرم‌ها عموما از تعدادی پروتکل از پیش تعیین شده استفاده می‌کنند.
پروتکل‌های ارتباطی مانند \متن‌لاتین{MQTT}
و یا \متن‌لاتین{HTTP} برای ارتباط شناخته شده هستند.
در صورتی که بخواهیم داده‌ها را از شبکه‌هایی غیر از اینترنت مانند \متن‌لاتین{LoRaWAN}
دریافت کنیم می‌بایست یک کامپوننت دیگر توسعه داده که داده‌ها را دریافت و آن‌ها به ساختار
داده‌ای پلتفرم تغییر دهد.

\زیرزیرقسمت{مدیریت داده‌ها}

داده‌ها کلید برنامه‌های اینترنت اشیا هستند. در اینترنت اشیا داده‌ها عموما به داده‌های حسگرها
یا هر داده‌ای از شبکه‌ی زیرساخت که برای برنامه‌های کاربردی اهمیت داشته باشد گفته می‌شود.
میان‌افزار اینترنت اشیا نیاز دارد تا سرویس‌های مدیریت داده شامل جمع‌آوری داده، پردازش داده و ذخیره‌سازی
آن را برای برنامه‌های کاربردی فراهم آورد.
پردازش و پیش‌پردازش می‌تواند شامل فیلتر کردن، فشرده‌سازی و ترکیب باشد.

\متن‌سیاه{دریافت داده‌ها}

عموما پلتفرم‌های اینترنت اشیا داده‌ها را در یک ساختار مشخص
دریافت می‌کنند.
استانداردهایی مانند \متن‌لاتین{SenML} برای ساختار داده‌ها می‌توانند سربار تبدیل
ساختار داخل پلتفرم‌ها را از بین ببرند.

\متن‌سیاه{مدل داده‌ای}

برای اشیا و توانایی‌های مرتبط با آن‌ها نیاز به تعریف داریم. این تعریف می‌بایست توسط کاربر صورت
گرفته و به پلتفرم داده شود. برای این قسمت \متن‌لاتین{OneDM} کاربری خواهد بود.

\متن‌سیاه{ترکیب داده‌ها}

یکی از نیازمندی‌های پلتفرم تجمیع داده‌ها و استفاده از نتیجه آن است.
برای پیاده‌سازی این قسمت می‌توان یک \متن‌لاتین{Rule Engine} داشت و جریان‌های داده‌ای
را به واسطه آن پردازش کرد.

\زیرزیرقسمت{پیدا کردن سرویس‌ها و منابع}

یکی از قابلیت‌های مهم در پلتفرم‌ها توانایی شناسایی اشیا موجود، سرویس‌های ارائه شده توسط آن‌ها و وضعیت سلامتی‌شان است.
برای اینکار یکی نیازمندی اصلی وجود تعریف از شی و قابلیت‌های آن است.
مساله مهم دیگر زمان‌بندی استفاده از اشیا است. با توجه به وضعیت سلامتی یک شی و درخواست‌های موجود می‌بایست اشیا
به طرز بهینه‌ای تخصیص و زمان‌بندی شوند.

از آنجایی که محیط و زیرساخت اینترنت اشیا پویا است، فرض‌های مربتط با دانش کلی یا قطعی در رابطه با دسترسی‌پذیری این
منابع نادرست هستند.
از آنجایی که دخالت انسانی در پیدا کردن منابع ناممکن است، پیدا کردن سرویس‌ها می‌بایست به صورت خودکار صورت بگیرد.

\زیرزیرقسمت{مدیریت منابع}

کیفیت سرویس قابل قبولی برای همه برنامه‌های کاربردی مورد انتظار است و در محیطی مانند محیط اینترنت اشیا که منابع تاثیرگذار بر کیفیت سرویس
محدود هستند، مهم است که سرویسی برای برنامه‌ها در جهت مدیریت این منابع فراهم شود.

\زیرزیرقسمت{مدیریت رویدادها}

به صورت بالقوه تعداد بسیار زیادی رویداد در برنامه‌های کاربردی اینترنت اشیا تولید می‌شوند
که می‌بایست به واسطه یک قسمت داخلی از میان‌افزار اینترنت اشیا مدیریت شوند.
مدیریت رویدادها یک رویداد مشاهده‌ای ساده را به یک رویداد با معنی تبدیل می‌کند.

\زیرزیرقسمت{ارتباط دستگاه به دستگاه}

پلتفرم‌ها نیاز دارند تا اجازه برقرار ارتباط مستقیم بین دستگاه‌ها از طریق خودشان را بدهند چرا که دستگاه‌ها از پروتکل‌های ارتباطی متفاوتی استفاده می‌کنند
و ممکن است نتوانند به صورت مسقتیم با یکدیگر ارتباط برقرار کنند و از سوی دیگر برخی از پروتکل‌ها مانند \متن‌لاتین{LoRaWAN} اجازه ارتباط مستقیم میان
دستگاه‌ها را نمی‌دهند.

\زیرزیرقسمت{قابلیت اجرا در لبه}

پلتفرم‌ها می‌بایست به صورت ماژولار طراحی شوند و بتوان با فعال و غیرفعال‌سازی آن‌ها منابع مصرفی پلتلفرم را تغییر داد و به این ترتیب بتوان آن را در محیط‌هایی
با منابع محدود مثل لبه‌ها اجرا کرد.

\زیرزیرقسمت{مدیریت کد}

استقرار کدها در محیط‌های اینترنت اشیا کاری چالش برانگیز است و می‌بایست به صورت مستقیم توسط میان‌افزار پشتیبانی شود.
این سرویس می‌بایست نودهای مورد نظر جهت اجرای کد را انتخاب کرده و از سوی دیگر باید بتواند کدها را میان نودها جابجا کند.
